version: 2

models:
  - name: weekly_order_revenue
    description: >
      calculating the total weekly revenue.
      Used SUM(cleaned_amount).
    columns:
    - name: order_id
      tests:
        - not_null

    - name: week_start
      tests:
        - not_null

    - name: weekly_revenue
      description: >
        Weekly revenue should be or more than 0
      tests:
        - not_null
        - dbt_utils.expression_is_true:
            expression: ">= 0"
